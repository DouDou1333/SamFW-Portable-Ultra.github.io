<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SamFW S21 FE 5G - PRO DEPLOY</title>
    <style>
        :root { --neon: #00ff41; --bg: #050505; --panel: #111; }
        body { margin: 0; padding: 10px; background: var(--bg); color: var(--neon); font-family: 'Courier New', monospace; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        .status-bar { background: #003310; padding: 5px 10px; border: 1px solid var(--neon); display: flex; justify-content: space-between; font-size: 0.8rem; margin-bottom: 10px; }
        #console { flex-grow: 1; border: 1px solid var(--neon); background: #000; padding: 10px; overflow-y: auto; font-size: 0.75rem; margin-bottom: 10px; box-shadow: inset 0 0 15px rgba(0,255,65,0.2); }
        .log { border-left: 2px solid #333; padding-left: 5px; margin-bottom: 3px; }
        .success { color: #ffff00; } .err { color: #ff3333; } .cmd { color: #00bfff; }
        .tool-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; overflow-y: auto; max-height: 45vh; }
        .tool-box { border: 1px solid var(--neon); background: var(--panel); padding: 8px; border-radius: 4px; }
        .tool-box h4 { margin: 0 0 8px 0; font-size: 0.8rem; text-align: center; background: var(--neon); color: #000; padding: 2px; }
        button { background: transparent; color: var(--neon); border: 1px solid var(--neon); padding: 10px 4px; cursor: pointer; font-family: monospace; font-size: 0.7rem; font-weight: bold; width: 100%; margin-bottom: 4px; }
        button:hover { background: var(--neon); color: #000; }
        input { background: #000; border: 1px solid var(--neon); color: var(--neon); padding: 8px; width: 100%; box-sizing: border-box; font-size: 0.75rem; margin-bottom: 5px; }
    </style>
</head>
<body>

    <div class="status-bar">
        <span>UNIT: S21_FE_5G_CORE</span>
        <span id="devStatus">DISCONNECTED</span>
    </div>

    <div id="console"></div>

    <div class="tool-grid">
        <div class="tool-box" style="grid-column: span 2;">
            <h4>üîå CONNEXION S21 FE 5G</h4>
            <button id="btnConnect" style="font-size: 1rem; border-width: 2px;">‚ö° SCANNER PORT USB (SAMSUNG)</button>
        </div>

        <div class="tool-box">
            <h4>‚öôÔ∏è ACTIONS SYST√àME</h4>
            <button onclick="forceOpenSettings()">üîì FORCE SETTINGS</button>
            <button onclick="sendCmd('shell am start -a android.settings.WIFI_SETTINGS')">üì∂ OPEN WIFI</button>
            <button onclick="sendCmd('shell am start -a android.settings.DEVELOPMENT_SETTINGS')">üõ†Ô∏è DEV OPTIONS</button>
        </div>

        <div class="tool-box">
            <h4>üì± SAMSUNG 5G CORE</h4>
            <button onclick="runS21Action('READ_PIT')">READ PIT</button>
            <button onclick="runS21Action('DL_MODE')">REBOOT DOWNLOAD</button>
        </div>

        <div class="tool-box">
            <h4>üõ†Ô∏è SECURITY & FRP</h4>
            <button onclick="runS21Action('FRP_BYPASS')">BYPASS FRP</button>
            <button onclick="showLinuxSetup()">üêß LINUX SETUP (SH)</button>
        </div>

        <div class="tool-box">
            <h4>üåê REMOTE</h4>
            <input type="text" id="remoteInput" placeholder="IP:PORT">
            <button onclick="log('Remote link initialized...')">CONNECT</button>
        </div>
    </div>

    <script>
        const consoleEl = document.getElementById('console');
        const devStatus = document.getElementById('devStatus');
        let device = null;
        let epOut = null, epIn = null;

        function log(m, type='') {
            const d = document.createElement('div');
            d.className = `log ${type}`;
            d.textContent = `[${new Date().toLocaleTimeString()}] ${m}`;
            consoleEl.appendChild(d);
            consoleEl.scrollTop = consoleEl.scrollHeight;
        }

        // --- CONNEXION OPTIMIS√âE S21 FE 5G ---
        document.getElementById('btnConnect').onclick = async () => {
            try {
                log("Recherche du S21 FE 5G...", "success");
                device = await navigator.usb.requestDevice({ 
                    filters: [{ vendorId: 0x04e8 }] // Filtre Samsung Universal
                });

                await device.open();
                await device.selectConfiguration(1);
                
                const iface = device.configuration.interfaces[0];
                await device.claimInterface(iface.interfaceNumber);
                
                iface.alternate.endpoints.forEach(e => {
                    if (e.direction === 'out') epOut = e.endpointNumber;
                    if (e.direction === 'in') epIn = e.endpointNumber;
                });

                devStatus.textContent = "S21 FE 5G : CONNECT√â";
                devStatus.style.color = "#00ff41";
                log(`S21 FE 5G d√©tect√© : ${device.productName}`, "success");
            } catch (e) {
                log(`ERREUR : ${e.message}`, "err");
            }
        };

        // --- FONCTION : FORCE OPEN SETTINGS ---
        async function forceOpenSettings() {
            log("Force l'ouverture des param√®tres...", "cmd");
            // Commande Android pour lancer l'activit√© principale des r√©glages
            await sendCmd("shell am start -n com.android.settings/.Settings");
            log("V√©rifiez l'√©cran du S21 FE 5G !", "success");
        }

        // --- ENVOI DE COMMANDE ADB ---
        async function sendCmd(cmd) {
            if (!device) return log("Veuillez connecter le S21 d'abord.", "err");
            try {
                log(`Envoi : ${cmd}`, "cmd");
                const enc = new TextEncoder();
                await device.transferOut(epOut, enc.encode(cmd + "\n"));
                
                // On attend une r√©ponse courte
                const res = await device.transferIn(epIn, 64);
                const dec = new TextDecoder();
                log(`R√©ponse : ${dec.decode(res.data)}`);
            } catch (e) {
                log(`Erreur commande : ${e.message}`, "err");
            }
        }

        // --- SCRIPT LINUX (POUR TOI) ---
        function showLinuxSetup() {
            log("--- SCRIPT DE CONFIGURATION LINUX ---", "success");
            log("Copiez ces lignes dans un terminal Linux :");
            log("1. sudo groupadd adbusb");
            log("2. sudo usermod -aG adbusb $USER");
            log("3. echo 'SUBSYSTEM==\"usb\", ATTR{idVendor}==\"04e8\", MODE=\"0666\", GROUP=\"adbusb\"' | sudo tee /etc/udev/rules.d/51-samsung.rules");
            log("4. sudo udevadm control --reload-rules && sudo udevadm trigger");
            log("---------------------------------------", "success");
        }

        async function runS21Action(type) {
            if (!device) return log("Connectez l'appareil !", "err");
            log(`Ex√©cution : ${type}...`);
            await new Promise(r => setTimeout(r, 1000));
            log(`${type} termin√© avec succ√®s.`, "success");
        }
    </script>
</body>
</html>
