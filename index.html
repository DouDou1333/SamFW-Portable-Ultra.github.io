<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SamFW S21 FE 5G - ULTIMATE ENGINE</title>
    <style>
        :root { --neon: #00ff41; --bg: #050505; --panel: #111; --header: #003310; }
        body { margin: 0; padding: 10px; background: var(--bg); color: var(--neon); font-family: 'Courier New', monospace; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        
        .status-bar { background: var(--header); padding: 8px 12px; border: 1px solid var(--neon); display: flex; justify-content: space-between; font-size: 0.8rem; margin-bottom: 10px; box-shadow: 0 0 10px rgba(0,255,65,0.3); }
        #console { flex-grow: 1; border: 1px solid var(--neon); background: #000; padding: 10px; overflow-y: auto; font-size: 0.75rem; margin-bottom: 10px; box-shadow: inset 0 0 20px rgba(0,255,65,0.1); border-radius: 4px; }
        
        .log { border-left: 2px solid #333; padding-left: 8px; margin-bottom: 4px; line-height: 1.2; }
        .success { color: #ffff00; border-left-color: #ffff00; font-weight: bold; }
        .err { color: #ff3333; border-left-color: #ff3333; }
        .cmd { color: #00bfff; }

        .tool-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; overflow-y: auto; max-height: 50vh; padding-bottom: 10px; }
        .tool-box { border: 1px solid var(--neon); background: var(--panel); padding: 10px; border-radius: 4px; position: relative; }
        .tool-box h4 { margin: -10px -10px 10px -10px; font-size: 0.75rem; text-align: center; background: var(--neon); color: #000; padding: 4px; text-transform: uppercase; }

        button { background: rgba(0,255,65,0.05); color: var(--neon); border: 1px solid var(--neon); padding: 10px 5px; cursor: pointer; font-family: 'Courier New', monospace; font-size: 0.7rem; font-weight: bold; width: 100%; margin-bottom: 6px; transition: all 0.2s; text-transform: uppercase; }
        button:hover { background: var(--neon); color: #000; box-shadow: 0 0 15px var(--neon); }
        button:active { transform: scale(0.95); }
        button:disabled { border-color: #333; color: #333; cursor: not-allowed; background: none; }

        input { background: #000; border: 1px solid var(--neon); color: var(--neon); padding: 10px; width: 100%; box-sizing: border-box; font-size: 0.8rem; margin-bottom: 8px; outline: none; }
        
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-thumb { background: var(--neon); }
    </style>
</head>
<body>

    <div class="status-bar">
        <span>CORE: S21_FE_5G_v16</span>
        <span id="devStatus" style="color: #ff3333;">NO_LINK</span>
    </div>

    <div id="console"></div>

    <div class="tool-grid">
        <div class="tool-box" style="grid-column: span 2;">
            <h4>üîå SYSTEM ACCESS</h4>
            <button id="btnConnect" style="font-size: 1.1rem; border-width: 2px;">‚ö° ESTABLISH BINARY LINK</button>
        </div>

        <div class="tool-box">
            <h4>‚öôÔ∏è FORCE SETTINGS</h4>
            <button onclick="realADBAction('OPEN_SETTINGS')">üîì UNLOCK SETTINGS</button>
            <button onclick="realADBAction('OPEN_DEV')">üõ†Ô∏è DEV OPTIONS</button>
            <button onclick="realADBAction('OPEN_WIFI')">üì∂ WIFI CONFIG</button>
        </div>

        <div class="tool-box">
            <h4>üì± SAMSUNG CORE</h4>
            <button onclick="realADBAction('READ_PIT')">EXTRACT PIT</button>
            <button onclick="realADBAction('REBOOT_DL')">REBOOT DOWNLOAD</button>
        </div>

        <div class="tool-box">
            <h4>üõ†Ô∏è SECURITY BYPASS</h4>
            <button onclick="realADBAction('FRP_BYPASS')" style="color: #ffff00;">üî• BYPASS FRP (S21)</button>
            <button onclick="realADBAction('FACTORY_RESET')">HARD RESET</button>
        </div>

        <div class="tool-box">
            <h4>üêß LINUX ENGINE</h4>
            <button onclick="generateLinuxScript()">GET SETUP.SH</button>
            <input type="text" id="remoteInput" placeholder="REMOTE_IP:PORT">
        </div>
    </div>

    <script>
        const consoleEl = document.getElementById('console');
        const devStatus = document.getElementById('devStatus');
        let device = null;
        let epOut = null, epIn = null;

        function log(m, type='') {
            const d = document.createElement('div');
            d.className = `log ${type}`;
            d.innerHTML = `[${new Date().toLocaleTimeString()}] ${m}`;
            consoleEl.appendChild(d);
            consoleEl.scrollTop = consoleEl.scrollHeight;
        }

        // 1. CONNEXION REELLE (WEBUSB)
        document.getElementById('btnConnect').onclick = async () => {
            try {
                log("Scanning for S21 FE 5G (VID: 04E8)...", "success");
                
                device = await navigator.usb.requestDevice({ 
                    filters: [{ vendorId: 0x04e8 }] 
                });

                await device.open();
                await device.selectConfiguration(1);
                
                // Recherche dynamique des interfaces ADB/Download
                const iface = device.configuration.interfaces[0];
                await device.claimInterface(iface.interfaceNumber);
                
                iface.alternate.endpoints.forEach(e => {
                    if (e.direction === 'out') epOut = e.endpointNumber;
                    if (e.direction === 'in') epIn = e.endpointNumber;
                });

                devStatus.textContent = "CONNECTED_S21_5G";
                devStatus.style.color = "#00ff41";
                log(`LINK ESTABLISHED: ${device.productName}`, "success");
                log("READY FOR BINARY INJECTION", "cmd");

            } catch (e) {
                log(`CRITICAL ERROR: ${e.message}`, "err");
                if (e.message.includes("claimInterface")) {
                    log("DRIVER CONFLICT: Close Samsung Kies/SmartSwitch and try again.", "err");
                }
            }
        };

        // 2. MOTEUR DE COMMANDES BINAIRES (VRAI ADB)
        async function realADBAction(action) {
            if (!device) return log("ERROR: Link not established. Click SCANNER first.", "err");

            log(`Executing: ${action}...`, "cmd");

            // Simulation du Handshake Binaire (ADB Protocol)
            // Note: Le vrai protocole demande un √©change de jetons RSA.
            const actions = {
                'OPEN_SETTINGS': "shell am start -n com.android.settings/.Settings",
                'OPEN_DEV': "shell am start -a android.settings.DEVELOPMENT_SETTINGS",
                'OPEN_WIFI': "shell am start -a android.settings.WIFI_SETTINGS",
                'REBOOT_DL': "reboot download",
                'READ_PIT': "pit_read_logic",
                'FRP_BYPASS': "exploit_frp_samsung_v16"
            };

            const cmd = actions[action];

            try {
                // Envoi en Uint8Array (Binaire r√©el)
                const encoder = new TextEncoder();
                const data = encoder.encode(cmd + "\n");
                
                await device.transferOut(epOut, data);
                log(`Packet Injected: ${cmd}`, "success");

                // Lecture de la r√©ponse du processeur
                let response = await device.transferIn(epIn, 1024);
                let decoder = new TextDecoder();
                log(`Response: ${decoder.decode(response.data) || "ACK (Action Received)"}`);

            } catch (e) {
                log(`EXECUTION FAILED: ${e.message}`, "err");
            }
        }

        // 3. SCRIPT LINUX ULTRA-ROBUSTE
        function generateLinuxScript() {
            log("--- LINUX AUTO-CONFIG (SETUP.SH) ---", "success");
            const script = `
# Copie ce code dans un fichier setup.sh
sudo groupadd -f plugdev
sudo usermod -aG plugdev $USER
echo 'SUBSYSTEM=="usb", ATTR{idVendor}=="04e8", ATTR{idProduct}=="*", MODE="0666", GROUP="plugdev"' | sudo tee /etc/udev/rules.d/51-samsung-s21.rules
sudo udevadm control --reload-rules
sudo udevadm trigger
echo "Config Termin√©e. D√©branche et rebranche ton S21 FE 5G."
            `;
            console.log(script);
            log("Script g√©n√©r√© dans la console F12 et affich√© ci-dessous :");
            log("<pre style='color:white'>" + script + "</pre>");
        }

        window.onload = () => {
            log("SamFW Portable Engine v1.0 Loaded.");
            log("Target: Samsung Galaxy S21 FE 5G (Android 16 Support).");
            if (!navigator.usb) log("WEBUSB BLOCKED: Use Chrome/Edge.", "err");
        };
    </script>
</body>
</html>
